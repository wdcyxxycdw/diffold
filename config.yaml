# Diffold è®­ç»ƒé…ç½®æ–‡ä»¶

# æ•°æ®é…ç½®
data:
  data_dir: "./processed_data"
  batch_size: 1
  max_sequence_length: 256
  num_workers: 4
  use_msa: true
  fold: 0  # äº¤å‰éªŒè¯æŠ˜æ•° (0-9)

# æ¨¡å‹é…ç½®
model:
  rhofold_checkpoint: "./pretrained/model_20221010_params.pt"

# è®­ç»ƒé…ç½®
training:
  num_epochs: 100
  learning_rate: 0.0001
  weight_decay: 0.00001
  grad_clip_norm: 1.0
  warmup_steps: 1000  # é¢„çƒ­æ­¥æ•°ï¼ˆåŸºäºstepè€Œä¸æ˜¯epochï¼‰
  
  # è°ƒåº¦å™¨é…ç½®
  scheduler_type: "cosine"  # "cosine", "plateau"
  patience: 10
  
  # å­¦ä¹ ç‡ä¿®æ”¹é…ç½®
  learning_rate_modification:
    enable_runtime_modification: true  # å…è®¸è¿è¡Œæ—¶ä¿®æ”¹å­¦ä¹ ç‡
    save_modification_history: true   # ä¿å­˜ä¿®æ”¹å†å²
    log_lr_changes: true              # è®°å½•å­¦ä¹ ç‡å˜åŒ–æ—¥å¿—
    validation_checks:
      min_lr: 1.0e-7                  # æœ€å°å­¦ä¹ ç‡é™åˆ¶
      max_lr: 1.0e-1                  # æœ€å¤§å­¦ä¹ ç‡é™åˆ¶
      warn_on_large_changes: true     # å¯¹å¤§å¹…åº¦å˜åŒ–å‘å‡ºè­¦å‘Š
      large_change_threshold: 10.0    # å¤§å¹…åº¦å˜åŒ–çš„é˜ˆå€¼ï¼ˆå€æ•°ï¼‰
  
  # éªŒè¯é…ç½®
  validate_every: 1
  early_stopping_patience: 10

# è¾“å‡ºé…ç½®
output:
  output_dir: "./output"
  checkpoint_dir: "./checkpoints"
  save_every: 1
  keep_last_n_checkpoints: 100

# è®¾å¤‡é…ç½®
device:
  device: "auto"  # "auto", "cpu", "cuda"
  mixed_precision: true
  use_torch_compile: false
  torch_compile_mode: "default"  # "default", "reduce-overhead", "max-autotune"

# å¤šGPUé…ç½®
multi_gpu:
  use_data_parallel: true
  gpu_ids: null  # æŒ‡å®šGPU IDåˆ—è¡¨ï¼Œå¦‚ [0, 1, 2]

# äº¤å‰éªŒè¯é…ç½®
cross_validation:
  fold: 0  # å½“å‰ä½¿ç”¨çš„æŠ˜æ•° (0-9)
  num_folds: 10
  use_all_folds: false

# æ—¥å¿—é…ç½®
logging:
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# æµ‹è¯•é…ç½®
test:
  test_mode: false
  test_samples: 10
  test_epochs: 5

# ğŸ”¥ å¢å¼ºåŠŸèƒ½é…ç½®
enhanced_features:
  enable_enhanced_training: true  # æ€»å¼€å…³
  
  # ç›‘æ§é…ç½®
  monitoring:
    enable_performance_monitoring: true
    enable_memory_monitoring: true
    enable_health_checking: true
    monitoring_interval: 1
    save_monitoring_plots: true
    memory_cleanup_threshold: 0.85
  
  # ä¼˜åŒ–å™¨é…ç½®
  optimizer:
    use_advanced_optimizer: true
    optimizer_name: "adamw"  # "adamw", "adam", "sgd", "lion"
    gradient_accumulation_steps: 1
    scheduler_type: "warmup_cosine"  # "warmup_cosine", "warmup_cosine_restarts", "plateau"
  
  # æ•°æ®åŠ è½½å™¨é…ç½®
  dataloader:
    enable_prefetch: true
    prefetch_factor: 2
    cache_size: 100
    pin_memory: true
    persistent_workers: true
  
  # è¯„ä¼°é…ç½®
  evaluation:
    compute_structure_metrics: true
    compute_confidence_metrics: true
    save_predictions: false
  
  # é”™è¯¯æ¢å¤é…ç½®
  error_recovery:
    auto_retry_on_oom: true
    max_retry_attempts: 3
    reduce_batch_size_on_oom: true 